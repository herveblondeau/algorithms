using System.Collections.Generic;
using FluentAssertions;
using Microsoft.VisualStudio.TestTools.UnitTesting;

namespace Algorithms.AdventOfCode._2024;

[TestClass]
public class Day13ClawContraptionTests
{

    #region Part 1

    [TestMethod]
    public void CalculateNbTokens_SampleMap_PerformsCorrectly()
    {
        // Arrange
        Day13ClawContraption day13ClawContraption = new();
        var map = _getSampleMachines();

        // Act
        var actual = day13ClawContraption.CalculateNbTokens(map);

        // Assert
        actual.Should().Be(480);
    }

    [TestMethod]
    public void CalculateNbTokens_TestMap_PerformsCorrectly()
    {
        // Arrange
        Day13ClawContraption day13ClawContraption = new();
        var map = _getTestMachines();

        // Act
        var actual = day13ClawContraption.CalculateNbTokens(map);

        // Assert
        actual.Should().Be(31552);
    }

    #endregion

    #region Part 2

    [TestMethod]
    public void CalculateNbTokensEquation_TestMap_PerformsCorrectly()
    {
        // Arrange
        Day13ClawContraption day13ClawContraption = new();
        var map = _getTestMachines();

        // Act
        var actual = day13ClawContraption.CalculateNbTokensEquation(map);

        // Assert
        actual.Should().Be(95273925552482);
    }

    #endregion

    private List<((int DeltaX, int DeltaY) ButtonA, (int DeltaX, int DeltaY) ButtonB, (long X, long Y) Prize)> _getSampleMachines()
    {
        return
        [
            ((94, 34), (22, 67), (8400, 5400)),
            ((26, 66), (67, 21), (12748, 12176)),
            ((17, 86), (84, 37), (7870, 6450)),
            ((69, 23), (27, 71), (18641, 10279)),
        ];
    }

    private List<((int DeltaX, int DeltaY) ButtonA, (int DeltaX, int DeltaY) ButtonB, (long X, long Y) Prize)> _getTestMachines()
    {
        return
        [
            ((62, 54), (19, 93), (4094, 11058)),
            ((55, 93), (83, 27), (9995, 7833)),
            ((83, 31), (21, 34), (8042, 4233)),
            ((21, 11), (11, 23), (13963, 17749)),
            ((65, 97), (83, 12), (6919, 3278)),
            ((28, 17), (16, 43), (19828, 14869)),
            ((26, 12), (40, 59), (19660, 1040)),
            ((17, 80), (77, 16), (11125, 19344)),
            ((41, 77), (97, 15), (6430, 4386)),
            ((18, 58), (68, 24), (3136, 3276)),
            ((40, 39), (21, 98), (2893, 8480)),
            ((57, 11), (42, 99), (7356, 6237)),
            ((21, 61), (72, 24), (7049, 5889)),
            ((55, 21), (20, 37), (17600, 18892)),
            ((39, 79), (51, 14), (11165, 15493)),
            ((59, 97), (35, 19), (1331, 1957)),
            ((65, 21), (23, 54), (8456, 3041)),
            ((29, 52), (42, 17), (7340, 17904)),
            ((97, 15), (78, 75), (10291, 6060)),
            ((14, 48), (49, 26), (18015, 4490)),
            ((47, 16), (38, 68), (4834, 6688)),
            ((76, 19), (16, 62), (18040, 6100)),
            ((15, 43), (44, 15), (18354, 6234)),
            ((27, 73), (63, 20), (18080, 2029)),
            ((52, 78), (73, 31), (6369, 3823)),
            ((16, 55), (33, 16), (19647, 4165)),
            ((23, 17), (37, 86), (2569, 3893)),
            ((18, 57), (70, 17), (10998, 4825)),
            ((16, 31), (61, 36), (262, 11902)),
            ((48, 27), (13, 43), (6877, 7117)),
            ((13, 36), (49, 27), (5930, 12113)),
            ((62, 21), (31, 76), (3184, 1310)),
            ((55, 13), (33, 83), (11298, 1134)),
            ((68, 13), (63, 92), (2972, 888)),
            ((18, 24), (71, 11), (6903, 2427)),
            ((84, 17), (40, 53), (4860, 1253)),
            ((74, 39), (17, 51), (5051, 6797)),
            ((65, 18), (24, 76), (9457, 8214)),
            ((66, 22), (14, 43), (810, 14750)),
            ((12, 82), (93, 70), (3672, 9258)),
            ((63, 26), (35, 56), (3948, 3998)),
            ((51, 25), (28, 54), (3832, 4456)),
            ((24, 62), (67, 33), (14082, 8066)),
            ((33, 15), (28, 54), (4793, 1049)),
            ((58, 25), (27, 60), (5684, 3440)),
            ((51, 27), (12, 33), (6641, 12200)),
            ((91, 41), (39, 93), (9633, 11355)),
            ((16, 41), (60, 19), (11624, 17434)),
            ((23, 62), (70, 33), (6285, 5378)),
            ((63, 38), (24, 52), (18713, 4086)),
            ((92, 17), (44, 96), (6932, 9980)),
            ((92, 99), (99, 17), (9724, 2585)),
            ((95, 16), (63, 62), (11570, 5032)),
            ((49, 18), (18, 28), (5064, 2288)),
            ((35, 77), (53, 14), (16536, 13857)),
            ((14, 41), (89, 71), (8902, 8623)),
            ((49, 17), (27, 70), (18325, 2157)),
            ((20, 57), (54, 18), (19442, 3419)),
            ((11, 25), (72, 42), (8781, 6799)),
            ((20, 48), (61, 37), (10609, 5109)),
            ((19, 45), (42, 12), (253, 1835)),
            ((15, 48), (64, 16), (17517, 13728)),
            ((52, 13), (25, 66), (8798, 10188)),
            ((20, 46), (51, 30), (12086, 9494)),
            ((21, 58), (63, 22), (17063, 1590)),
            ((11, 39), (75, 30), (2732, 8453)),
            ((57, 26), (26, 47), (16605, 523)),
            ((64, 21), (18, 80), (2504, 5860)),
            ((83, 15), (56, 57), (4586, 4251)),
            ((33, 13), (27, 58), (12359, 17846)),
            ((19, 39), (59, 19), (7183, 19763)),
            ((17, 11), (22, 49), (9203, 17789)),
            ((28, 99), (87, 11), (2165, 6765)),
            ((69, 28), (52, 70), (10406, 8428)),
            ((30, 12), (53, 76), (13030, 14808)),
            ((17, 49), (47, 28), (9223, 9615)),
            ((33, 34), (76, 15), (2661, 1982)),
            ((19, 50), (44, 15), (8425, 17470)),
            ((80, 45), (17, 65), (3863, 4335)),
            ((27, 16), (14, 28), (8861, 17640)),
            ((32, 91), (61, 52), (5445, 10504)),
            ((13, 42), (58, 38), (6888, 14140)),
            ((25, 61), (40, 11), (1375, 16891)),
            ((11, 52), (75, 29), (4368, 12074)),
            ((22, 53), (56, 29), (7670, 8250)),
            ((32, 11), (32, 68), (7360, 16987)),
            ((18, 46), (33, 16), (3564, 2548)),
            ((11, 46), (54, 32), (10843, 10358)),
            ((60, 83), (32, 13), (16748, 18281)),
            ((32, 59), (97, 19), (6823, 6346)),
            ((96, 60), (47, 94), (9828, 10020)),
            ((12, 72), (81, 86), (3333, 8398)),
            ((59, 30), (54, 97), (7038, 5804)),
            ((21, 45), (48, 27), (12056, 269)),
            ((80, 31), (30, 82), (4020, 5921)),
            ((80, 35), (25, 55), (6620, 4130)),
            ((31, 18), (13, 31), (15898, 6859)),
            ((80, 30), (20, 43), (5820, 3283)),
            ((13, 27), (34, 15), (17252, 377)),
            ((49, 11), (40, 76), (16449, 15823)),
            ((92, 32), (28, 48), (7096, 2736)),
            ((22, 76), (54, 13), (19030, 18217)),
            ((98, 24), (56, 62), (1162, 864)),
            ((32, 80), (72, 45), (4448, 7340)),
            ((45, 16), (14, 27), (13215, 3378)),
            ((13, 25), (34, 19), (8660, 3962)),
            ((78, 32), (12, 61), (14312, 6693)),
            ((17, 72), (53, 53), (1650, 5445)),
            ((99, 51), (12, 53), (10587, 9293)),
            ((19, 62), (72, 52), (6359, 8310)),
            ((75, 31), (13, 40), (8828, 551)),
            ((64, 14), (26, 42), (6138, 3122)),
            ((23, 89), (92, 15), (10143, 5490)),
            ((19, 45), (71, 52), (1728, 1421)),
            ((72, 19), (32, 62), (8328, 4929)),
            ((15, 77), (44, 11), (16875, 8812)),
            ((13, 66), (82, 31), (10424, 874)),
            ((53, 27), (36, 58), (1610, 2010)),
            ((16, 82), (71, 16), (6923, 8694)),
            ((95, 73), (13, 61), (8506, 10464)),
            ((78, 23), (12, 59), (4266, 4031)),
            ((31, 87), (71, 36), (1330, 2100)),
            ((15, 55), (38, 13), (16129, 12049)),
            ((74, 18), (14, 50), (6380, 1904)),
            ((36, 19), (13, 31), (13245, 15500)),
            ((37, 16), (18, 33), (13068, 10692)),
            ((56, 20), (29, 62), (5211, 3462)),
            ((26, 59), (45, 19), (399, 7100)),
            ((52, 14), (25, 77), (2490, 9454)),
            ((42, 11), (20, 36), (9786, 1137)),
            ((61, 14), (49, 93), (6529, 7303)),
            ((27, 17), (12, 41), (11438, 1948)),
            ((53, 11), (54, 88), (5465, 5665)),
            ((15, 77), (78, 18), (4700, 10332)),
            ((11, 59), (48, 19), (15210, 9409)),
            ((16, 52), (41, 17), (8584, 11248)),
            ((56, 13), (29, 68), (2453, 17869)),
            ((35, 91), (76, 17), (3918, 6033)),
            ((77, 57), (21, 50), (5152, 6708)),
            ((91, 83), (75, 12), (12690, 8190)),
            ((14, 55), (73, 19), (11601, 15256)),
            ((50, 22), (15, 90), (5055, 5310)),
            ((18, 89), (68, 44), (3436, 7638)),
            ((39, 17), (33, 62), (3546, 5593)),
            ((12, 37), (69, 37), (14282, 9906)),
            ((63, 14), (12, 59), (13250, 17592)),
            ((36, 13), (11, 27), (2067, 13051)),
            ((20, 41), (66, 12), (5388, 3894)),
            ((20, 56), (67, 13), (19450, 8218)),
            ((78, 54), (12, 79), (1170, 6324)),
            ((90, 18), (85, 85), (3190, 2542)),
            ((41, 55), (33, 11), (4748, 13212)),
            ((14, 32), (71, 43), (7996, 7508)),
            ((21, 62), (29, 12), (9063, 14936)),
            ((22, 62), (55, 16), (2156, 4130)),
            ((59, 14), (74, 83), (12057, 8358)),
            ((14, 37), (76, 19), (5898, 2312)),
            ((91, 15), (59, 69), (3305, 1671)),
            ((15, 37), (49, 36), (7184, 9695)),
            ((20, 41), (43, 18), (463, 10089)),
            ((94, 44), (30, 82), (7600, 5868)),
            ((96, 13), (32, 33), (3424, 693)),
            ((36, 68), (79, 14), (7294, 4312)),
            ((20, 68), (60, 23), (8420, 15573)),
            ((27, 74), (62, 17), (3968, 16866)),
            ((73, 29), (17, 45), (3900, 5444)),
            ((27, 52), (36, 12), (693, 876)),
            ((37, 18), (31, 51), (6019, 18734)),
            ((29, 76), (42, 13), (11614, 2906)),
            ((14, 42), (59, 35), (18349, 11813)),
            ((68, 48), (39, 92), (6801, 9636)),
            ((25, 41), (75, 35), (7025, 4481)),
            ((64, 37), (11, 21), (6001, 11072)),
            ((58, 26), (28, 70), (6296, 7648)),
            ((14, 53), (81, 42), (6345, 17070)),
            ((14, 42), (62, 18), (2166, 18194)),
            ((20, 75), (48, 33), (2368, 5058)),
            ((25, 46), (47, 19), (13106, 17558)),
            ((44, 16), (45, 82), (3277, 2570)),
            ((86, 30), (21, 91), (4067, 8029)),
            ((31, 80), (85, 38), (4335, 7560)),
            ((61, 23), (17, 47), (4852, 2260)),
            ((60, 15), (21, 57), (13505, 1985)),
            ((36, 16), (27, 43), (16037, 9885)),
            ((46, 13), (21, 66), (13369, 6940)),
            ((14, 45), (26, 16), (9320, 13990)),
            ((14, 26), (92, 25), (8294, 4318)),
            ((53, 19), (14, 26), (16384, 10312)),
            ((52, 75), (63, 26), (6045, 2816)),
            ((15, 43), (71, 23), (16775, 9495)),
            ((69, 33), (40, 99), (6091, 4191)),
            ((99, 32), (36, 51), (7065, 5787)),
            ((47, 70), (60, 26), (2586, 2014)),
            ((91, 27), (31, 68), (8982, 8310)),
            ((93, 45), (32, 62), (2799, 1773)),
            ((19, 38), (45, 13), (13235, 531)),
            ((25, 44), (59, 27), (5501, 2843)),
            ((18, 36), (68, 43), (2396, 13667)),
            ((67, 31), (16, 61), (9339, 13839)),
            ((50, 18), (59, 94), (7668, 6544)),
            ((76, 12), (56, 66), (7032, 6426)),
            ((14, 37), (65, 35), (13499, 18892)),
            ((17, 35), (21, 12), (4779, 16569)),
            ((35, 41), (83, 16), (4487, 1276)),
            ((39, 37), (95, 15), (6688, 2814)),
            ((26, 55), (35, 15), (8743, 6110)),
            ((42, 34), (22, 75), (958, 2720)),
            ((67, 20), (18, 60), (14996, 6200)),
            ((13, 49), (68, 33), (17288, 1213)),
            ((13, 56), (67, 31), (4233, 3808)),
            ((65, 17), (13, 45), (7790, 14958)),
            ((42, 17), (11, 44), (18067, 5940)),
            ((14, 40), (49, 11), (5873, 4009)),
            ((70, 27), (26, 42), (9094, 6513)),
            ((58, 31), (16, 30), (2210, 10445)),
            ((38, 79), (80, 54), (10226, 10477)),
            ((61, 51), (34, 96), (1296, 1962)),
            ((66, 24), (60, 83), (5970, 7249)),
            ((77, 33), (15, 56), (5348, 10861)),
            ((97, 16), (15, 75), (3718, 2644)),
            ((18, 66), (57, 23), (1331, 461)),
            ((86, 19), (11, 68), (11493, 13480)),
            ((58, 19), (27, 65), (4463, 3989)),
            ((22, 99), (58, 47), (4658, 9619)),
            ((41, 77), (83, 15), (3826, 5354)),
            ((61, 87), (88, 23), (9185, 7872)),
            ((29, 85), (92, 70), (1756, 3350)),
            ((34, 14), (34, 53), (9560, 6383)),
            ((58, 22), (27, 57), (3229, 11191)),
            ((23, 11), (24, 63), (17926, 17857)),
            ((13, 73), (99, 22), (979, 1760)),
            ((85, 14), (69, 68), (3893, 1604)),
            ((35, 70), (48, 13), (13198, 8123)),
            ((19, 48), (41, 17), (12712, 4069)),
            ((76, 29), (74, 98), (2248, 1974)),
            ((18, 60), (36, 33), (4716, 7716)),
            ((13, 38), (35, 21), (15360, 18553)),
            ((30, 86), (79, 47), (8027, 8115)),
            ((29, 11), (43, 59), (9067, 12323)),
            ((37, 12), (13, 37), (5632, 200)),
            ((83, 20), (19, 72), (6469, 6548)),
            ((65, 20), (21, 61), (16475, 4040)),
            ((44, 14), (36, 78), (5748, 16506)),
            ((30, 11), (20, 57), (14450, 18684)),
            ((67, 19), (22, 72), (13334, 18046)),
            ((44, 46), (85, 16), (4389, 2184)),
            ((61, 28), (24, 62), (9152, 946)),
            ((62, 11), (30, 63), (6224, 5084)),
            ((60, 33), (15, 28), (16985, 17028)),
            ((17, 45), (45, 26), (12775, 255)),
            ((32, 52), (39, 14), (16202, 7912)),
            ((51, 11), (90, 96), (2856, 1918)),
            ((55, 14), (21, 59), (7579, 18566)),
            ((20, 45), (47, 32), (6786, 15691)),
            ((83, 59), (11, 83), (1447, 4111)),
            ((70, 23), (16, 59), (14404, 585)),
            ((20, 50), (55, 28), (9160, 1204)),
            ((68, 55), (12, 42), (3188, 3838)),
            ((69, 80), (11, 89), (5158, 6819)),
            ((29, 61), (55, 13), (3197, 8483)),
            ((74, 25), (11, 56), (12703, 15991)),
            ((60, 15), (42, 95), (4998, 9615)),
            ((23, 32), (87, 34), (10409, 6300)),
            ((11, 44), (71, 24), (13268, 17872)),
            ((13, 60), (63, 22), (6522, 5106)),
            ((87, 32), (11, 66), (4834, 4504)),
            ((55, 22), (21, 52), (11757, 2214)),
            ((28, 69), (37, 13), (3138, 17965)),
            ((77, 13), (19, 30), (4100, 2782)),
            ((29, 55), (49, 27), (17241, 12611)),
            ((23, 13), (23, 75), (3427, 7703)),
            ((43, 32), (17, 55), (907, 1649)),
            ((20, 71), (65, 39), (6270, 5768)),
            ((11, 58), (81, 17), (330, 17911)),
            ((22, 31), (54, 16), (4142, 1570)),
            ((25, 79), (68, 12), (19174, 458)),
            ((15, 55), (47, 18), (6941, 19714)),
            ((60, 30), (48, 77), (4812, 5533)),
            ((71, 48), (15, 61), (2520, 3026)),
            ((26, 12), (18, 29), (3506, 16969)),
            ((16, 80), (82, 39), (8130, 10599)),
            ((32, 79), (89, 36), (8654, 4095)),
            ((28, 75), (85, 60), (2856, 2955)),
            ((91, 51), (20, 68), (9032, 6936)),
            ((36, 80), (43, 12), (14547, 14252)),
            ((95, 16), (25, 23), (2855, 1627)),
            ((46, 23), (49, 93), (2124, 2295)),
            ((27, 84), (53, 11), (10279, 17893)),
            ((19, 55), (42, 23), (12761, 2299)),
            ((50, 66), (75, 30), (1550, 1770)),
            ((27, 95), (85, 17), (3986, 3306)),
            ((95, 49), (19, 85), (8056, 7088)),
            ((49, 68), (88, 34), (3014, 2244)),
            ((46, 30), (17, 41), (13436, 18172)),
            ((69, 28), (23, 60), (5566, 3576)),
            ((44, 54), (12, 82), (4236, 11186)),
            ((11, 64), (79, 24), (13813, 11296)),
            ((68, 68), (13, 93), (1895, 3095)),
            ((45, 17), (44, 77), (284, 19673)),
            ((68, 14), (67, 78), (8070, 7440)),
            ((73, 11), (21, 95), (1919, 7085)),
            ((26, 72), (97, 35), (2263, 3697)),
            ((33, 13), (36, 51), (17687, 14407)),
            ((62, 35), (31, 60), (15832, 16295)),
            ((62, 29), (36, 89), (8392, 10059)),
            ((55, 28), (48, 91), (6081, 8554)),
            ((13, 34), (84, 42), (2351, 3128)),
            ((14, 31), (47, 30), (13965, 6961)),
            ((88, 74), (15, 63), (7553, 10735)),
            ((70, 20), (55, 77), (11750, 9118)),
            ((43, 61), (35, 15), (5417, 8049)),
            ((46, 25), (28, 52), (4390, 3379)),
            ((25, 57), (50, 13), (2025, 3102)),
            ((62, 13), (24, 64), (1698, 1023)),
            ((16, 71), (61, 19), (5497, 4908)),
            ((23, 97), (35, 20), (3969, 10486)),
            ((96, 24), (71, 71), (5168, 2144)),
            ((44, 73), (33, 11), (15511, 6412)),
            ((42, 23), (17, 40), (1178, 2018)),
            ((44, 95), (47, 32), (7163, 9560)),
        ];
    }
}
